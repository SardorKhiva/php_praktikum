/*  3-masala. 2003 - yil, noyabr oyida buyurtma qilingan maxsulotlarning,
jami 130 tadan ortiq sotilganlarini, productCode, produkt nomi va
nechta buyurtma qilinganligi sonini chiqaring  */
# `orders` `orderdetails`
USE `mashq`;
SELECT * FROM `orders` LIMIT 3;  /* orders JADVALI BILAN QISQA TANISHAMIZ:
+-------------+------------+--------------+-------------+---------+------------------------+----------------+
| orderNumber | orderDate  | requiredDate | shippedDate | status  | comments               | customerNumber |
+-------------+------------+--------------+-------------+---------+------------------------+----------------+
|       10100 | 2003-01-06 | 2003-01-13   | 2003-01-10  | Shipped | NULL                   |            363 |
|       10101 | 2003-01-09 | 2003-01-18   | 2003-01-11  | Shipped | Check on availability. |            128 |
|       10102 | 2003-01-10 | 2003-01-18   | 2003-01-14  | Shipped | NULL                   |            181 |
+-------------+------------+--------------+-------------+---------+------------------------+---------------*/

SELECT * FROM `orderdetails` LIMIT 3;  /*
+-------------+-------------+-----------------+-----------+-----------------+
| orderNumber | productCode | quantityOrdered | priceEach | orderLineNumber |
+-------------+-------------+-----------------+-----------+-----------------+
|       10100 | S18_1749    |              30 |    136.00 |               3 |
|       10100 | S18_2248    |              50 |     55.09 |               2 |
|       10100 | S18_4409    |              22 |     75.46 |               4 |
+-------------+-------------+-----------------+-----------+----------------*/

# 2003-yil noyabr oyi buyurtmalarini topamiz:
SELECT `o`.`orderNumber`
FROM `orders` AS `o`
WHERE YEAR(`o`.`orderDate`) = 2003
  AND MONTH(`o`.`orderDate`) = 11;
/*------------+
| orderNumber |
+-------------+
|       10169 |
|       10170 |
|       10171 |
|       10172 |
|       10173 |
|       10174 |
|       10175 |
|       10176 |
|       10177 |
|       10178 |
|       10179 |
|       10180 |
|       10181 |
|       10182 |
|       10183 |
|       10184 |
|       10185 |
|       10186 |
|       10187 |
|       10188 |
|       10189 |
|       10190 |
|       10191 |
|       10192 |
|       10193 |
|       10194 |
|       10195 |
|       10196 |
|       10197 |
|       10198 |
+------------*/

/* JOIN bilan `orderdetails` jadvalidan, yuqorida topilgan `orders`larda qanaqa product
va nechtadan buyurtma qilinganini aniqlaymiz: */
SELECT `o`.`orderNumber`,
       `od`.`productCode`,
       `od`.`quantityOrdered`
FROM `orders` `o`
INNER JOIN `orderdetails` `od`
ON `o`.`orderNumber` = `od`.`orderNumber`
WHERE YEAR(`o`.`orderDate`) = 2003
AND MONTH(`o`.`orderDate`) = 11;
/*------------+-------------+-----------------+
| orderNumber | productCode | quantityOrdered |
+-------------+-------------+-----------------+
|       10169 | S12_1099    |              30 |
|       10169 | S12_2823    |              35 |
|       10169 | S12_3990    |              36 |
|       10169 | S18_3278    |              32 |
|       10169 | S18_3482    |              36 |
|       10169 | S18_3782    |              38 |
|       10169 | S18_4721    |              33 |
|       10169 | S24_2360    |              38 |
|       10169 | S24_3371    |              34 |
|       10169 | S24_4620    |              24 |
|       10169 | S32_2206    |              26 |
|       10169 | S32_4485    |              34 |
|       10169 | S50_4713    |              48 |
|       10170 | S12_3380    |              47 |
|       10170 | S12_4675    |              41 |
|       10170 | S18_1889    |              20 |
|       10170 | S24_3856    |              34 |
|       10171 | S18_1129    |              35 |
|       10171 | S18_1984    |              35 |
|       10171 | S18_3232    |              39 |
|       10171 | S24_2972    |              36 |
|       10172 | S18_1589    |              42 |
|       10172 | S18_2870    |              39 |
|       10172 | S18_3685    |              48 |
|       10172 | S24_1046    |              32 |
|       10172 | S24_1628    |              34 |
|       10172 | S24_2766    |              22 |
|       10172 | S24_3191    |              24 |
|       10172 | S24_3432    |              22 |
|       10173 | S18_1342    |              43 |
|       10173 | S18_1367    |              48 |
|       10173 | S18_1749    |              24 |
|       10173 | S18_2248    |              26 |
|       10173 | S18_2325    |              31 |
|       10173 | S18_2795    |              22 |
|       10173 | S18_2957    |              28 |
|       10173 | S18_3136    |              31 |
|       10173 | S18_3320    |              29 |
|       10173 | S18_4409    |              21 |
|       10173 | S18_4933    |              39 |
|       10173 | S24_1937    |              31 |
|       10173 | S24_2022    |              27 |
|       10173 | S24_2887    |              23 |
|       10173 | S24_3969    |              35 |
|       10173 | S24_4258    |              22 |
|       10174 | S10_1949    |              34 |
|       10174 | S12_1666    |              43 |
|       10174 | S18_1097    |              48 |
|       10174 | S18_2949    |              46 |
|       10174 | S18_4668    |              49 |
|       10175 | S10_4962    |              33 |
|       10175 | S12_4473    |              26 |
|       10175 | S18_2319    |              48 |
|       10175 | S18_2432    |              41 |
|       10175 | S18_3232    |              29 |
|       10175 | S18_4600    |              47 |
|       10175 | S24_2300    |              28 |
|       10175 | S24_2840    |              37 |
|       10175 | S32_1268    |              22 |
|       10175 | S32_2509    |              50 |
|       10175 | S32_3522    |              29 |
|       10175 | S700_2824   |              42 |
|       10176 | S12_1108    |              33 |
|       10176 | S12_3148    |              47 |
|       10176 | S12_3891    |              50 |
|       10176 | S18_2238    |              20 |
|       10176 | S18_4027    |              36 |
|       10176 | S24_1444    |              27 |
|       10176 | S24_4048    |              29 |
|       10176 | S32_3207    |              22 |
|       10176 | S50_1392    |              23 |
|       10176 | S50_1514    |              38 |
|       10177 | S18_3140    |              23 |
|       10177 | S18_3259    |              29 |
|       10177 | S18_4522    |              35 |
|       10177 | S24_2011    |              50 |
|       10177 | S24_3151    |              45 |
|       10177 | S700_1138   |              24 |
|       10177 | S700_1938   |              31 |
|       10177 | S700_2610   |              32 |
|       10177 | S700_3505   |              44 |
|       10177 | S700_3962   |              24 |
|       10177 | S72_3212    |              40 |
|       10178 | S10_4757    |              24 |
|       10178 | S18_1662    |              42 |
|       10178 | S18_3029    |              41 |
|       10178 | S18_3856    |              48 |
|       10178 | S24_2841    |              34 |
|       10178 | S24_3420    |              27 |
|       10178 | S24_3816    |              21 |
|       10178 | S24_3949    |              30 |
|       10178 | S700_2047   |              34 |
|       10178 | S700_2466   |              22 |
|       10178 | S700_4002   |              45 |
|       10178 | S72_1253    |              45 |
|       10179 | S18_2581    |              24 |
|       10179 | S24_1785    |              47 |
|       10179 | S24_4278    |              27 |
|       10179 | S32_1374    |              45 |
|       10179 | S32_4289    |              24 |
|       10179 | S50_1341    |              34 |
|       10179 | S700_1691   |              23 |
|       10179 | S700_2834   |              25 |
|       10179 | S700_3167   |              39 |
|       10180 | S10_1678    |              29 |
|       10180 | S10_2016    |              42 |
|       10180 | S10_4698    |              41 |
|       10180 | S12_2823    |              40 |
|       10180 | S18_2625    |              25 |
|       10180 | S18_3782    |              21 |
|       10180 | S18_4721    |              44 |
|       10180 | S24_1578    |              48 |
|       10180 | S24_2000    |              28 |
|       10180 | S24_2360    |              35 |
|       10180 | S24_4620    |              28 |
|       10180 | S32_2206    |              34 |
|       10180 | S32_4485    |              22 |
|       10180 | S50_4713    |              21 |
|       10181 | S12_1099    |              27 |
|       10181 | S12_3380    |              28 |
|       10181 | S12_3990    |              20 |
|       10181 | S12_4675    |              36 |
|       10181 | S18_1129    |              44 |
|       10181 | S18_1589    |              42 |
|       10181 | S18_1889    |              22 |
|       10181 | S18_1984    |              21 |
|       10181 | S18_2870    |              27 |
|       10181 | S18_3232    |              45 |
|       10181 | S18_3278    |              30 |
|       10181 | S18_3482    |              22 |
|       10181 | S18_3685    |              39 |
|       10181 | S24_1628    |              34 |
|       10181 | S24_2972    |              37 |
|       10181 | S24_3371    |              23 |
|       10181 | S24_3856    |              25 |
|       10182 | S18_1342    |              25 |
|       10182 | S18_1367    |              32 |
|       10182 | S18_1749    |              44 |
|       10182 | S18_2248    |              38 |
|       10182 | S18_2325    |              20 |
|       10182 | S18_2795    |              21 |
|       10182 | S18_3320    |              33 |
|       10182 | S18_4409    |              36 |
|       10182 | S18_4933    |              44 |
|       10182 | S24_1046    |              47 |
|       10182 | S24_1937    |              39 |
|       10182 | S24_2022    |              31 |
|       10182 | S24_2766    |              36 |
|       10182 | S24_2887    |              20 |
|       10182 | S24_3191    |              33 |
|       10182 | S24_3432    |              49 |
|       10182 | S24_3969    |              23 |
|       10183 | S10_1949    |              23 |
|       10183 | S10_4962    |              28 |
|       10183 | S12_1666    |              41 |
|       10183 | S18_1097    |              21 |
|       10183 | S18_2949    |              37 |
|       10183 | S18_2957    |              39 |
|       10183 | S18_3136    |              22 |
|       10183 | S18_4600    |              21 |
|       10183 | S18_4668    |              40 |
|       10183 | S24_4258    |              47 |
|       10183 | S32_3522    |              49 |
|       10183 | S700_2824   |              23 |
|       10184 | S12_4473    |              37 |
|       10184 | S18_2238    |              46 |
|       10184 | S18_2319    |              46 |
|       10184 | S18_2432    |              44 |
|       10184 | S18_3232    |              28 |
|       10184 | S24_1444    |              31 |
|       10184 | S24_2300    |              24 |
|       10184 | S24_2840    |              42 |
|       10184 | S24_4048    |              49 |
|       10184 | S32_1268    |              46 |
|       10184 | S32_2509    |              33 |
|       10184 | S32_3207    |              48 |
|       10184 | S50_1392    |              45 |
|       10185 | S12_1108    |              21 |
|       10185 | S12_3148    |              33 |
|       10185 | S12_3891    |              43 |
|       10185 | S18_3140    |              28 |
|       10185 | S18_3259    |              49 |
|       10185 | S18_4027    |              39 |
|       10185 | S18_4522    |              47 |
|       10185 | S24_2011    |              30 |
|       10185 | S24_3151    |              33 |
|       10185 | S50_1514    |              20 |
|       10185 | S700_1138   |              21 |
|       10185 | S700_1938   |              30 |
|       10185 | S700_2610   |              39 |
|       10185 | S700_3505   |              37 |
|       10185 | S700_3962   |              22 |
|       10185 | S72_3212    |              28 |
|       10186 | S10_4757    |              26 |
|       10186 | S18_1662    |              32 |
|       10186 | S18_3029    |              32 |
|       10186 | S18_3856    |              46 |
|       10186 | S24_2841    |              22 |
|       10186 | S24_3420    |              21 |
|       10186 | S24_3816    |              36 |
|       10186 | S700_2047   |              24 |
|       10186 | S72_1253    |              28 |
|       10187 | S18_2581    |              45 |
|       10187 | S24_1785    |              46 |
|       10187 | S24_3949    |              43 |
|       10187 | S24_4278    |              33 |
|       10187 | S32_4289    |              31 |
|       10187 | S50_1341    |              41 |
|       10187 | S700_1691   |              34 |
|       10187 | S700_2466   |              44 |
|       10187 | S700_3167   |              34 |
|       10187 | S700_4002   |              44 |
|       10188 | S10_1678    |              48 |
|       10188 | S10_2016    |              38 |
|       10188 | S10_4698    |              45 |
|       10188 | S18_2625    |              32 |
|       10188 | S24_1578    |              25 |
|       10188 | S24_2000    |              40 |
|       10188 | S32_1374    |              44 |
|       10188 | S700_2834   |              29 |
|       10189 | S12_2823    |              28 |
|       10190 | S24_2360    |              42 |
|       10190 | S32_2206    |              46 |
|       10190 | S32_4485    |              42 |
|       10190 | S50_4713    |              40 |
|       10191 | S12_1099    |              21 |
|       10191 | S12_3380    |              40 |
|       10191 | S12_3990    |              30 |
|       10191 | S18_3278    |              36 |
|       10191 | S18_3482    |              23 |
|       10191 | S18_3782    |              43 |
|       10191 | S18_4721    |              32 |
|       10191 | S24_3371    |              48 |
|       10191 | S24_4620    |              44 |
|       10192 | S12_4675    |              27 |
|       10192 | S18_1129    |              22 |
|       10192 | S18_1589    |              29 |
|       10192 | S18_1889    |              45 |
|       10192 | S18_1984    |              47 |
|       10192 | S18_2870    |              38 |
|       10192 | S18_3232    |              26 |
|       10192 | S18_3685    |              45 |
|       10192 | S24_1046    |              37 |
|       10192 | S24_1628    |              47 |
|       10192 | S24_2766    |              46 |
|       10192 | S24_2887    |              23 |
|       10192 | S24_2972    |              30 |
|       10192 | S24_3191    |              32 |
|       10192 | S24_3432    |              46 |
|       10192 | S24_3856    |              45 |
|       10193 | S18_1342    |              28 |
|       10193 | S18_1367    |              46 |
|       10193 | S18_1749    |              21 |
|       10193 | S18_2248    |              42 |
|       10193 | S18_2325    |              44 |
|       10193 | S18_2795    |              22 |
|       10193 | S18_2949    |              28 |
|       10193 | S18_2957    |              24 |
|       10193 | S18_3136    |              23 |
|       10193 | S18_3320    |              32 |
|       10193 | S18_4409    |              24 |
|       10193 | S18_4933    |              25 |
|       10193 | S24_1937    |              26 |
|       10193 | S24_2022    |              20 |
|       10193 | S24_3969    |              22 |
|       10193 | S24_4258    |              20 |
|       10194 | S10_1949    |              42 |
|       10194 | S10_4962    |              26 |
|       10194 | S12_1666    |              38 |
|       10194 | S18_1097    |              21 |
|       10194 | S18_2432    |              45 |
|       10194 | S18_4600    |              32 |
|       10194 | S18_4668    |              41 |
|       10194 | S24_2300    |              49 |
|       10194 | S32_1268    |              37 |
|       10194 | S32_3522    |              39 |
|       10194 | S700_2824   |              26 |
|       10195 | S12_4473    |              49 |
|       10195 | S18_2238    |              27 |
|       10195 | S18_2319    |              35 |
|       10195 | S18_3232    |              50 |
|       10195 | S24_1444    |              44 |
|       10195 | S24_2840    |              32 |
|       10195 | S24_4048    |              34 |
|       10195 | S32_2509    |              32 |
|       10195 | S32_3207    |              33 |
|       10195 | S50_1392    |              49 |
|       10196 | S12_1108    |              47 |
|       10196 | S12_3148    |              24 |
|       10196 | S12_3891    |              38 |
|       10196 | S18_3140    |              49 |
|       10196 | S18_3259    |              35 |
|       10196 | S18_4027    |              27 |
|       10196 | S50_1514    |              46 |
|       10196 | S700_1938   |              50 |
|       10197 | S10_4757    |              45 |
|       10197 | S18_3029    |              46 |
|       10197 | S18_3856    |              22 |
|       10197 | S18_4522    |              50 |
|       10197 | S24_2011    |              41 |
|       10197 | S24_3151    |              47 |
|       10197 | S24_3816    |              22 |
|       10197 | S700_1138   |              23 |
|       10197 | S700_2047   |              24 |
|       10197 | S700_2610   |              50 |
|       10197 | S700_3505   |              27 |
|       10197 | S700_3962   |              35 |
|       10197 | S72_1253    |              29 |
|       10197 | S72_3212    |              42 |
|       10198 | S18_1662    |              42 |
|       10198 | S24_2841    |              48 |
|       10198 | S24_3420    |              27 |
|       10198 | S24_3949    |              43 |
|       10198 | S700_2466   |              42 |
|       10198 | S700_4002   |              40 |
+-------------+-------------+----------------*/

# Endi har bir product dan nechtadan buyurtma qilinganligini SUM yordamida aniqlaymiz:
SELECT `od`.`productCode`,
    SUM(`od`.`quantityOrdered`) 'jami'
FROM `orders` `o`
INNER JOIN `orderdetails` `od`
ON `o`.`orderNumber` = `od`.`orderNumber`
WHERE YEAR(`o`.`orderDate`) = 2003
AND MONTH(`o`.`orderDate`) = 11
GROUP BY `od`.`productCode`;
/*------------+------+
| productCode | jami |
+-------------+------+
| S12_1099    |   78 |
| S12_2823    |  103 |
| S12_3990    |   86 |
| S18_3278    |   98 |
| S18_3482    |   81 |
| S18_3782    |  102 |
| S18_4721    |  109 |
| S24_2360    |  115 |
| S24_3371    |  105 |
| S24_4620    |   96 |
| S32_2206    |  106 |
| S32_4485    |   98 |
| S50_4713    |  109 |
| S12_3380    |  115 |
| S12_4675    |  104 |
| S18_1889    |   87 |
| S24_3856    |  104 |
| S18_1129    |  101 |
| S18_1984    |  103 |
| S18_3232    |  217 |
| S24_2972    |  103 |
| S18_1589    |  113 |
| S18_2870    |  104 |
| S18_3685    |  132 |
| S24_1046    |  116 |
| S24_1628    |  115 |
| S24_2766    |  104 |
| S24_3191    |   89 |
| S24_3432    |  117 |
| S18_1342    |   96 |
| S18_1367    |  126 |
| S18_1749    |   89 |
| S18_2248    |  106 |
| S18_2325    |   95 |
| S18_2795    |   65 |
| S18_2957    |   91 |
| S18_3136    |   76 |
| S18_3320    |   94 |
| S18_4409    |   81 |
| S18_4933    |  108 |
| S24_1937    |   96 |
| S24_2022    |   78 |
| S24_2887    |   66 |
| S24_3969    |   80 |
| S24_4258    |   89 |
| S10_1949    |   99 |
| S12_1666    |  122 |
| S18_1097    |   90 |
| S18_2949    |  111 |
| S18_4668    |  130 |
| S10_4962    |   87 |
| S12_4473    |  112 |
| S18_2319    |  129 |
| S18_2432    |  130 |
| S18_4600    |  100 |
| S24_2300    |  101 |
| S24_2840    |  111 |
| S32_1268    |  105 |
| S32_2509    |  115 |
| S32_3522    |  117 |
| S700_2824   |   91 |
| S12_1108    |  101 |
| S12_3148    |  104 |
| S12_3891    |  131 |
| S18_2238    |   93 |
| S18_4027    |  102 |
| S24_1444    |  102 |
| S24_4048    |  112 |
| S32_3207    |  103 |
| S50_1392    |  117 |
| S50_1514    |  104 |
| S18_3140    |  100 |
| S18_3259    |  113 |
| S18_4522    |  132 |
| S24_2011    |  121 |
| S24_3151    |  125 |
| S700_1138   |   68 |
| S700_1938   |  111 |
| S700_2610   |  121 |
| S700_3505   |  108 |
| S700_3962   |   81 |
| S72_3212    |  110 |
| S10_4757    |   95 |
| S18_1662    |  116 |
| S18_3029    |  119 |
| S18_3856    |  116 |
| S24_2841    |  104 |
| S24_3420    |   75 |
| S24_3816    |   79 |
| S24_3949    |  116 |
| S700_2047   |   82 |
| S700_2466   |  108 |
| S700_4002   |  129 |
| S72_1253    |  102 |
| S18_2581    |   69 |
| S24_1785    |   93 |
| S24_4278    |   60 |
| S32_1374    |   89 |
| S32_4289    |   55 |
| S50_1341    |   75 |
| S700_1691   |   57 |
| S700_2834   |   54 |
| S700_3167   |   73 |
| S10_1678    |   77 |
| S10_2016    |   80 |
| S10_4698    |   86 |
| S18_2625    |   57 |
| S24_1578    |   73 |
| S24_2000    |   68 |
+-------------+-----*/

# Endi productCode orqali product nomini aniqlaymiz:
SELECT `od`.`productCode`,
       `p`.`productName`,
       SUM(`od`.`quantityOrdered`) 'jami'
FROM `orders` `o`
INNER JOIN `orderdetails` `od`
  ON `o`.`orderNumber` = `od`.`orderNumber`
LEFT JOIN `products` `p`
  ON `p`.`productCode` = `od`.`productCode`
WHERE YEAR(`o`.`orderDate`) = 2003
  AND MONTH(`o`.`orderDate`) = 11
GROUP BY `od`.`productCode`;
/*------------+---------------------------------------------+------+
| productCode | productName                                 | jami |
+-------------+---------------------------------------------+------+
| S12_1099    | 1968 Ford Mustang                           |   78 |
| S12_2823    | 2002 Suzuki XREO                            |  103 |
| S12_3990    | 1970 Plymouth Hemi Cuda                     |   86 |
| S18_3278    | 1969 Dodge Super Bee                        |   98 |
| S18_3482    | 1976 Ford Gran Torino                       |   81 |
| S18_3782    | 1957 Vespa GS150                            |  102 |
| S18_4721    | 1957 Corvette Convertible                   |  109 |
| S24_2360    | 1982 Ducati 900 Monster                     |  115 |
| S24_3371    | 1971 Alpine Renault 1600s                   |  105 |
| S24_4620    | 1961 Chevrolet Impala                       |   96 |
| S32_2206    | 1982 Ducati 996 R                           |  106 |
| S32_4485    | 1974 Ducati 350 Mk3 Desmo                   |   98 |
| S50_4713    | 2002 Yamaha YZR M1                          |  109 |
| S12_3380    | 1968 Dodge Charger                          |  115 |
| S12_4675    | 1969 Dodge Charger                          |  104 |
| S18_1889    | 1948 Porsche 356-A Roadster                 |   87 |
| S24_3856    | 1956 Porsche 356A Coupe                     |  104 |
| S18_1129    | 1993 Mazda RX-7                             |  101 |
| S18_1984    | 1995 Honda Civic                            |  103 |
| S18_3232    | 1992 Ferrari 360 Spider red                 |  217 |
| S24_2972    | 1982 Lamborghini Diablo                     |  103 |
| S18_1589    | 1965 Aston Martin DB5                       |  113 |
| S18_2870    | 1999 Indy 500 Monte Carlo SS                |  104 |
| S18_3685    | 1948 Porsche Type 356 Roadster              |  132 |
| S24_1046    | 1970 Chevy Chevelle SS 454                  |  116 |
| S24_1628    | 1966 Shelby Cobra 427 S/C                   |  115 |
| S24_2766    | 1949 Jaguar XK 120                          |  104 |
| S24_3191    | 1969 Chevrolet Camaro Z28                   |   89 |
| S24_3432    | 2002 Chevy Corvette                         |  117 |
| S18_1342    | 1937 Lincoln Berline                        |   96 |
| S18_1367    | 1936 Mercedes-Benz 500K Special Roadster    |  126 |
| S18_1749    | 1917 Grand Touring Sedan                    |   89 |
| S18_2248    | 1911 Ford Town Car                          |  106 |
| S18_2325    | 1932 Model A Ford J-Coupe                   |   95 |
| S18_2795    | 1928 Mercedes-Benz SSK                      |   65 |
| S18_2957    | 1934 Ford V8 Coupe                          |   91 |
| S18_3136    | 18th Century Vintage Horse Carriage         |   76 |
| S18_3320    | 1917 Maxwell Touring Car                    |   94 |
| S18_4409    | 1932 Alfa Romeo 8C2300 Spider Sport         |   81 |
| S18_4933    | 1957 Ford Thunderbird                       |  108 |
| S24_1937    | 1939 Chevrolet Deluxe Coupe                 |   96 |
| S24_2022    | 1938 Cadillac V-16 Presidential Limousine   |   78 |
| S24_2887    | 1952 Citroen-15CV                           |   66 |
| S24_3969    | 1936 Mercedes Benz 500k Roadster            |   80 |
| S24_4258    | 1936 Chrysler Airflow                       |   89 |
| S10_1949    | 1952 Alpine Renault 1300                    |   99 |
| S12_1666    | 1958 Setra Bus                              |  122 |
| S18_1097    | 1940 Ford Pickup Truck                      |   90 |
| S18_2949    | 1913 Ford Model T Speedster                 |  111 |
| S18_4668    | 1939 Cadillac Limousine                     |  130 |
| S10_4962    | 1962 LanciaA Delta 16V                      |   87 |
| S12_4473    | 1957 Chevy Pickup                           |  112 |
| S18_2319    | 1964 Mercedes Tour Bus                      |  129 |
| S18_2432    | 1926 Ford Fire Engine                       |  130 |
| S18_4600    | 1940s Ford truck                            |  100 |
| S24_2300    | 1962 Volkswagen Microbus                    |  101 |
| S24_2840    | 1958 Chevy Corvette Limited Edition         |  111 |
| S32_1268    | 1980’s GM Manhattan Express                 |  105 |
| S32_2509    | 1954 Greyhound Scenicruiser                 |  115 |
| S32_3522    | 1996 Peterbilt 379 Stake Bed with Outrigger |  117 |
| S700_2824   | 1982 Camaro Z28                             |   91 |
| S12_1108    | 2001 Ferrari Enzo                           |  101 |
| S12_3148    | 1969 Corvair Monza                          |  104 |
| S12_3891    | 1969 Ford Falcon                            |  131 |
| S18_2238    | 1998 Chrysler Plymouth Prowler              |   93 |
| S18_4027    | 1970 Triumph Spitfire                       |  102 |
| S24_1444    | 1970 Dodge Coronet                          |  102 |
| S24_4048    | 1992 Porsche Cayenne Turbo Silver           |  112 |
| S32_3207    | 1950's Chicago Surface Lines Streetcar      |  103 |
| S50_1392    | Diamond T620 Semi-Skirted Tanker            |  117 |
| S50_1514    | 1962 City of Detroit Streetcar              |  104 |
| S18_3140    | 1903 Ford Model A                           |  100 |
| S18_3259    | Collectable Wooden Train                    |  113 |
| S18_4522    | 1904 Buick Runabout                         |  132 |
| S24_2011    | 18th century schooner                       |  121 |
| S24_3151    | 1912 Ford Model T Delivery Wagon            |  125 |
| S700_1138   | The Schooner Bluenose                       |   68 |
| S700_1938   | The Mayflower                               |  111 |
| S700_2610   | The USS Constitution Ship                   |  121 |
| S700_3505   | The Titanic                                 |  108 |
| S700_3962   | The Queen Mary                              |   81 |
| S72_3212    | Pont Yacht                                  |  110 |
| S10_4757    | 1972 Alfa Romeo GTA                         |   95 |
| S18_1662    | 1980s Black Hawk Helicopter                 |  116 |
| S18_3029    | 1999 Yamaha Speed Boat                      |  119 |
| S18_3856    | 1941 Chevrolet Special Deluxe Cabriolet     |  116 |
| S24_2841    | 1900s Vintage Bi-Plane                      |  104 |
| S24_3420    | 1937 Horch 930V Limousine                   |   75 |
| S24_3816    | 1940 Ford Delivery Sedan                    |   79 |
| S24_3949    | Corsair F4U ( Bird Cage)                    |  116 |
| S700_2047   | HMS Bounty                                  |   82 |
| S700_2466   | America West Airlines B757-200              |  108 |
| S700_4002   | American Airlines: MD-11S                   |  129 |
| S72_1253    | Boeing X-32A JSF                            |  102 |
| S18_2581    | P-51-D Mustang                              |   69 |
| S24_1785    | 1928 British Royal Navy Airplane            |   93 |
| S24_4278    | 1900s Vintage Tri-Plane                     |   60 |
| S32_1374    | 1997 BMW F650 ST                            |   89 |
| S32_4289    | 1928 Ford Phaeton Deluxe                    |   55 |
| S50_1341    | 1930 Buick Marquette Phaeton                |   75 |
| S700_1691   | American Airlines: B767-300                 |   57 |
| S700_2834   | ATA: B757-300                               |   54 |
| S700_3167   | F/A 18 Hornet 1/72                          |   73 |
| S10_1678    | 1969 Harley Davidson Ultimate Chopper       |   77 |
| S10_2016    | 1996 Moto Guzzi 1100i                       |   80 |
| S10_4698    | 2003 Harley-Davidson Eagle Drag Bike        |   86 |
| S18_2625    | 1936 Harley Davidson El Knucklehead         |   57 |
| S24_1578    | 1997 BMW R 1100 S                           |   73 |
| S24_2000    | 1960 BSA Gold Star DBD34                    |   68 |
+-------------+---------------------------------------------+-----*/

#       Endi 130 tadan ko'p sotilganlarini HAVING yordamida aniqlaymiz:
SELECT `od`.`productCode`,
       `p`.`productName`,
       SUM(`od`.`quantityOrdered`) 'jami'
FROM `orders` `o`
INNER JOIN `orderdetails` `od`
  ON `o`.`orderNumber` = `od`.`orderNumber`
LEFT JOIN `products` `p`
  ON `p`.`productCode` = `od`.`productCode`
WHERE YEAR(`o`.`orderDate`) = 2003
  AND MONTH(`o`.`orderDate`) = 11
GROUP BY `od`.`productCode`
HAVING `jami` > 130
ORDER BY `jami`;
/*+-----------+--------------------------------+------+
| productCode | productName                    | jami |
+-------------+--------------------------------+------+
| S12_3891    | 1969 Ford Falcon               |  131 |
| S18_3685    | 1948 Porsche Type 356 Roadster |  132 |
| S18_4522    | 1904 Buick Runabout            |  132 |
| S18_3232    | 1992 Ferrari 360 Spider red    |  217 |
+-------------+--------------------------------+------+
4 rows in set (0.01 sec) */