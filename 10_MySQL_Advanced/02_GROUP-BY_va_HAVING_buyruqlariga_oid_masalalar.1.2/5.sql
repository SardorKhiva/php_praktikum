/*  "orderdetails" jadvalidan:
5) har bir produkt jami necha so`mlik sotilganini chiqaring. (summasi)  */
USE `mashq`;

SELECT `productCode`                 AS 'mahsulot kodi',
SUM(`priceEach` * `quantityOrdered`) AS 'summa'
FROM `orderdetails`
GROUP BY `productCode`
ORDER BY `summa` DESC;
/* summani kamayish tartibida saralash:
+---------------+-----------+
| mahsulot kodi | summa     |
+---------------+-----------+
| S18_3232      | 276839.98 |
| S12_1108      | 190755.86 |
| S10_1949      | 190017.96 |
| S10_4698      | 170686.00 |
| S12_1099      | 161531.48 |
| S12_3891      | 152543.02 |
| S18_1662      | 144959.91 |
| S18_2238      | 142530.63 |
| S18_1749      | 140535.60 |
| S12_2823      | 135767.03 |
| S24_3856      | 134240.71 |
| S12_3148      | 132363.79 |
| S18_2795      | 132275.98 |
| S18_4721      | 130749.31 |
| S10_4757      | 127924.32 |
| S10_4962      | 123123.01 |
| S18_4027      | 122254.75 |
| S18_3482      | 121890.60 |
| S18_3685      | 121653.46 |
| S12_1666      | 119085.25 |
| S18_1984      | 119050.95 |
| S24_2300      | 118774.33 |
| S18_2319      | 117669.66 |
| S18_1129      | 114648.12 |
| S18_4600      | 114232.79 |
| S24_2011      | 112427.12 |
| S18_3140      | 111528.82 |
| S10_2016      | 109998.82 |
| S18_2325      | 109992.01 |
| S12_4473      | 109946.21 |
| S18_1097      | 105563.12 |
| S24_1578      | 105266.64 |
| S12_4675      | 104210.62 |
| S700_2834     | 102786.38 |
| S18_1342      | 102563.52 |
| S18_3856      | 102537.45 |
| S18_1589      | 101778.13 |
| S50_1392      | 101137.55 |
| S18_2870      | 100770.12 |
| S12_3380      |  98718.76 |
| S18_2949      |  97193.88 |
| S24_1785      |  94885.37 |
| S24_2887      |  94248.67 |
| S24_4048      |  92973.40 |
| S10_1678      |  90157.77 |
| S32_1374      |  89364.89 |
| S700_2466     |  89347.80 |
| S700_2824     |  89272.65 |
| S24_4258      |  88434.46 |
| S18_3320      |  87637.63 |
| S24_3432      |  87404.81 |
| S18_3136      |  85328.57 |
| S700_3505     |  84992.25 |
| S32_4485      |  84039.24 |
| S18_3259      |  82617.12 |
| S700_3962     |  78919.06 |
| S32_1268      |  78067.82 |
| S18_4522      |  77800.54 |
| S24_3151      |  77239.92 |
| S24_2766      |  76670.02 |
| S700_3167     |  76618.40 |
| S18_3029      |  74127.24 |
| S700_1691     |  73871.22 |
| S50_4713      |  73670.64 |
| S700_2047     |  73298.42 |
| S700_4002     |  71753.93 |
| S18_4409      |  71526.22 |
| S24_3816      |  71208.18 |
| S700_1938     |  69531.61 |
| S24_4620      |  69120.97 |
| S18_3278      |  68783.93 |
| S18_2581      |  68741.91 |
| S24_4278      |  68276.35 |
| S24_3191      |  67357.30 |
| S24_2000      |  67193.49 |
| S700_2610     |  66697.13 |
| S18_1889      |  66455.62 |
| S12_3990      |  63489.95 |
| S24_3949      |  62269.67 |
| S32_4289      |  60493.33 |
| S24_2841      |  58434.07 |
| S24_2360      |  57995.25 |
| S32_3522      |  57282.49 |
| S700_1138     |  56455.11 |
| S18_2432      |  55835.30 |
| S18_2957      |  55172.21 |
| S18_3782      |  54024.87 |
| S32_3207      |  53791.99 |
| S24_1046      |  53236.67 |
| S24_3420      |  52803.75 |
| S24_3371      |  52339.53 |
| S50_1514      |  52123.81 |
| S24_1444      |  50255.45 |
| S18_4933      |  50101.57 |
| S18_2625      |  49992.72 |
| S72_3212      |  47550.40 |
| S32_2509      |  46519.05 |
| S18_1367      |  46078.29 |
| S18_2248      |  45306.77 |
| S18_4668      |  44037.84 |
| S72_1253      |  42692.53 |
| S24_1628      |  42015.54 |
| S50_1341      |  41599.24 |
| S24_2022      |  38449.09 |
| S32_2206      |  33268.76 |
| S24_2840      |  31627.96 |
| S24_2972      |  30972.87 |
| S24_3969      |  29763.39 |
| S24_1937      |  28052.94 |
+---------------+-----------+
109 rows in set (0.01 sec)      */

/*  orderNumber      -- buyuretma, hujjat id
    productCode      -- mahsulot kodi
    quantityOrdered  -- nechta donaligi
    priceEach        -- 1 dona mahsulot narhi
    orderLineNumber  -- hujjatdagi mahsulot tartib raqami   */