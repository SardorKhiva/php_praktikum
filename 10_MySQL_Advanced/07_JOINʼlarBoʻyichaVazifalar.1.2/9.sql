/* 9-masala:
Har bir mijoz, har yilda qancha
$ lik to`lov qilganini aniqlang.
Familya bo`yicha saralang. */
/*-----------------+-----------------+------+-----------+
| contactFirstName | contactLastName | yil  | jami      |
+------------------+-----------------+------+-----------+
| Adrian           | Huxley          | 2003 |  24013.52 |
| Adrian           | Huxley          | 2005 |  31835.36 |
| Adrian           | Huxley          | 2004 |  35806.73 |
| Akiko            | Shimamura       | 2004 |  70965.55 |
| Akiko            | Shimamura       | 2005 |  34583.18 |
| Allen            | Nelson          | 2003 |  32680.31 |
| Allen            | Nelson          | 2005 |  28322.83 |
| Allen            | Nelson          | 2004 |  12530.51 |
| Ann              | Brown           | 2003 |  66884.91 |
| Ann              | Brown           | 2004 |  13671.82 |
| Anna             | O'Hara          | 2005 |  56932.30 | */

USE `mashq`;
SELECT `c`.`contactLastName`   AS 'familya', -- familya
       `c`.`contactFirstName`  AS 'ism',     -- ism
       YEAR(`p`.`paymentDate`) AS 'yil',
       SUM(`p`.`amount`)       AS 'summa'
FROM `customers` `c`
         JOIN `payments` `p`
              ON `c`.`customerNumber` = `p`.`customerNumber`
GROUP BY `c`.`contactLastName`, `c`.`contactFirstName`, `p`.`paymentDate`
# ORDER BY `familya`       -- familya bo'lsa buni commentdan chiqariladi
ORDER BY `ism`, `yil`;     -- agar ism kerak bo'lsa ishlatiladi
/*------------+---------------+------+-----------+
| familya     | ism           | yil  | summa     |
+-------------+---------------+------+-----------+
| Huxley      | Adrian        | 2003 |  24013.52 |
| Huxley      | Adrian        | 2004 |  35806.73 |
| Huxley      | Adrian        | 2005 |  31835.36 |
| Shimamura   | Akiko         | 2004 |  22037.91 |
| Shimamura   | Akiko         | 2004 |  48927.64 |
| Shimamura   | Akiko         | 2005 |  33967.73 |
| Shimamura   | Akiko         | 2005 |    615.45 |
| Nelson      | Allen         | 2003 |  32680.31 |
| Nelson      | Allen         | 2004 |  12530.51 |
| Nelson      | Allen         | 2005 |  28322.83 |
| Brown       | Ann           | 2003 |  29429.14 |
| Brown       | Ann           | 2003 |  37455.77 |
| Brown       | Ann           | 2004 |  13671.82 |
| O'Hara      | Anna          | 2003 |  38547.19 |
| O'Hara      | Anna          | 2003 |  41554.73 |
| O'Hara      | Anna          | 2005 |  27083.78 |
| O'Hara      | Anna          | 2005 |  29848.52 |
| Roulet      | Annette       | 2003 |  33818.34 |
| Roulet      | Annette       | 2003 |  14232.70 |
| Roulet      | Annette       | 2005 |  12432.32 |
| Cruz        | Arnold        | 2003 |  20644.24 |
| Cruz        | Arnold        | 2003 |  51001.22 |
| Cruz        | Arnold        | 2004 |  15822.84 |
| Calaghan    | Ben           | 2003 |  23936.53 |
| Calaghan    | Ben           | 2003 |   9821.32 |
| Calaghan    | Ben           | 2005 |  21432.31 |
| Chandler    | Brian         | 2003 |  20452.50 |
| Chandler    | Brian         | 2004 |  21053.69 |
| Schmitt     | Carine        | 2003 |  14571.44 |
| Schmitt     | Carine        | 2004 |   6066.78 |
| Schmitt     | Carine        | 2004 |   1676.14 |
| Dewey       | Catherine     | 2004 |  45352.47 |
| Dewey       | Catherine     | 2004 |  16901.38 |
| Berglund    | Christina     | 2003 |   7674.94 |
| Berglund    | Christina     | 2004 |  36005.71 |
| Lewis       | Dan           | 2003 |   6631.36 |
| Lewis       | Dan           | 2003 |  17032.29 |
| Lewis       | Dan           | 2004 |  26304.13 |
| Da Silva    | Daniel        | 2003 |  23419.47 |
| Da Silva    | Daniel        | 2004 |  26311.63 |
| Tonini      | Daniel        | 2004 |   5759.42 |
| Tonini      | Daniel        | 2004 |  53116.99 |
| Da Silva    | Daniel        | 2005 |  17928.09 |
| Cassidy     | Dean          | 2004 |  17359.53 |
| Cassidy     | Dean          | 2004 |  32538.74 |
| Freyre      | Diego         | 2003 |  36251.03 |
| Freyre      | Diego         | 2003 |  49539.37 |
| Freyre      | Diego         | 2003 |  40206.20 |
| Freyre      | Diego         | 2003 |  63843.55 |
| Freyre      | Diego         | 2004 |  36140.38 |
| Freyre      | Diego         | 2004 |  59830.55 |
| Freyre      | Diego         | 2004 | 116208.40 |
| Freyre      | Diego         | 2004 |  35420.74 |
| Freyre      | Diego         | 2004 |  20009.53 |
| Freyre      | Diego         | 2004 |  26155.91 |
| Freyre      | Diego         | 2005 |  46895.48 |
| Freyre      | Diego         | 2005 |  65071.26 |
| Freyre      | Diego         | 2005 | 120166.58 |
| Perrier     | Dominique     | 2004 |  49165.16 |
| Perrier     | Dominique     | 2004 |  25080.96 |
| Perrier     | Dominique     | 2005 |  12190.85 |
| Young       | Dorothy       | 2003 |  10223.83 |
| Young       | Dorothy       | 2003 |  55425.77 |
| Young       | Dorothy       | 2004 |  50799.69 |
| Saavedra    | Eduardo       | 2003 |   3101.40 |
| Saavedra    | Eduardo       | 2003 |  40473.86 |
| Saavedra    | Eduardo       | 2004 |  24945.21 |
| Devon       | Elizabeth     | 2003 |  23908.24 |
| Devon       | Elizabeth     | 2004 |  37258.94 |
| Lincoln     | Elizabeth     | 2004 |  37527.58 |
| Lincoln     | Elizabeth     | 2004 |  29284.42 |
| Natividad   | Eric          | 2003 |  44380.15 |
| Natividad   | Eric          | 2003 | 105743.00 |
| Natividad   | Eric          | 2004 |   2611.84 |
| Natividad   | Eric          | 2005 |   3516.04 |
| Cervantes   | Francisca     | 2003 |  34606.28 |
| Cervantes   | Francisca     | 2004 |  23333.06 |
| Ricotti     | Franco        | 2003 |  17746.26 |
| Ricotti     | Franco        | 2004 |   7612.06 |
| Citeaux     | Frédérique    | 2004 |   4632.31 |
| Citeaux     | Frédérique    | 2004 |  36069.26 |
| Citeaux     | Frédérique    | 2005 |  35157.75 |
| Pipps       | Georg         | 2003 |  35826.33 |
| Pipps       | Georg         | 2004 |   6419.84 |
| Pipps       | Georg         | 2004 |  42813.83 |
| Rovelli     | Giovanni      | 2003 |  52151.81 |
| Rovelli     | Giovanni      | 2003 |  37723.79 |
| Rovelli     | Giovanni      | 2004 |  37654.09 |
| Bennett     | Helen         | 2004 |  46788.14 |
| Bennett     | Helen         | 2004 |  24995.61 |
| Pfalzheim   | Henriette     | 2003 |  27988.47 |
| Pfalzheim   | Henriette     | 2004 |  61234.67 |
| Klaeboe     | Jan           | 2003 |  36798.88 |
| Klaeboe     | Jan           | 2004 |  32260.16 |
| Labrune     | Janine        | 2004 |  19501.82 |
| Labrune     | Janine        | 2004 |  47924.19 |
| Labrune     | Janine        | 2005 |  49523.67 |
| King        | Jean          | 2003 |  32641.98 |
| Fresnière   | Jean          | 2003 |  16909.84 |
| King        | Jean          | 2004 |  14191.12 |
| King        | Jean          | 2004 |  33347.88 |
| Fresnière   | Jean          | 2004 |  22997.45 |
| Fresnière   | Jean          | 2005 |  29070.38 |
| Young       | Jeff          | 2003 |  58793.53 |
| Young       | Jeff          | 2003 |  58841.35 |
| Young       | Jeff          | 2004 |  20314.44 |
| Young       | Jeff          | 2004 |  39964.63 |
| Tseng       | Jerry         | 2004 |  11843.45 |
| Tseng       | Jerry         | 2004 |  20355.24 |
| Fernandez   | Jesus         | 2003 |  31428.21 |
| Fernandez   | Jesus         | 2004 |  15322.93 |
| Bergulfsen  | Jonas         | 2003 |  50218.95 |
| Bergulfsen  | Jonas         | 2003 |   1491.38 |
| Bergulfsen  | Jonas         | 2004 |  17876.32 |
| Bergulfsen  | Jonas         | 2004 |  34638.14 |
| Roel        | José Pedro    | 2003 |  47513.19 |
| Roel        | José Pedro    | 2004 |   3474.66 |
| Murphy      | Julie         | 2003 |  23923.93 |
| Murphy      | Julie         | 2003 |  16537.85 |
| King        | Julie         | 2003 |  24879.08 |
| Young       | Julie         | 2003 |   3879.96 |
| Young       | Julie         | 2003 |  50342.74 |
| Brown       | Julie         | 2003 |  85559.12 |
| Murphy      | Julie         | 2004 |  26248.78 |
| King        | Julie         | 2004 |  42044.77 |
| King        | Julie         | 2005 |  28500.78 |
| Young       | Julie         | 2005 |  39580.60 |
| Brown       | Julie         | 2005 |  46781.66 |
| Hashimoto   | Juri          | 2003 |  50743.65 |
| Hashimoto   | Juri          | 2003 |  38675.13 |
| Hashimoto   | Juri          | 2004 |   2434.25 |
| Yoshido     | Juri          | 2004 |  18473.71 |
| Yoshido     | Juri          | 2004 |  15059.76 |
| Hashimoto   | Juri          | 2005 |  12692.19 |
| Petersen    | Jytte         | 2003 |  53959.21 |
| Petersen    | Jytte         | 2004 |   4710.73 |
| Petersen    | Jytte         | 2004 |  28211.70 |
| Petersen    | Jytte         | 2004 |  20564.86 |
| Suominen    | Kalle         | 2003 |  29716.86 |
| Suominen    | Kalle         | 2004 |  28394.54 |
| Suominen    | Kalle         | 2005 |  45785.34 |
| Leong       | Kelvin        | 2004 |  35152.12 |
| Leong       | Kelvin        | 2004 |  63357.13 |
| Lee         | Kwai          | 2003 |  22292.62 |
| Lee         | Kwai          | 2004 |  50025.35 |
| Lee         | Kwai          | 2004 |  35321.97 |
| Lebihan     | Laurence      | 2003 |  50824.66 |
| Lebihan     | Laurence      | 2004 |  18888.31 |
| Lebihan     | Laurence      | 2005 |   1834.56 |
| Taylor      | Leslie        | 2003 |   6036.96 |
| Murphy      | Leslie        | 2003 |  38139.18 |
| Taylor      | Leslie        | 2004 |   9658.74 |
| Taylor      | Leslie        | 2004 |   5858.56 |
| Murphy      | Leslie        | 2004 |  32239.47 |
| Hernandez   | Maria         | 2003 |  21665.98 |
| Hernandez   | Maria         | 2003 |  22042.37 |
| Hernandez   | Maria         | 2004 |  25505.98 |
| Bertrand    | Marie         | 2003 |  33383.14 |
| Bertrand    | Marie         | 2004 |   1960.80 |
| Bertrand    | Marie         | 2004 |  51209.58 |
| Hernandez   | Marta         | 2004 |  47411.33 |
| Hernandez   | Marta         | 2004 |  43134.04 |
| Larsson     | Martha        | 2004 |  48809.90 |
| Larsson     | Martha        | 2005 |  27966.54 |
| Sommer      | Martín        | 2003 |  57131.92 |
| Sommer      | Martín        | 2004 |  33145.56 |
| Sommer      | Martín        | 2004 |  22162.61 |
| Rancé       | Martine       | 2003 |  42783.81 |
| Rancé       | Martine       | 2004 |  18997.89 |
| Saveley     | Mary          | 2003 |  39712.10 |
| Young       | Mary          | 2003 |   4465.85 |
| Saveley     | Mary          | 2004 |  40978.53 |
| Saveley     | Mary          | 2004 |  49614.72 |
| Young       | Mary          | 2005 |   3452.75 |
| Karttunen   | Matti         | 2003 |  37602.48 |
| Karttunen   | Matti         | 2004 |  34341.08 |
| Karttunen   | Matti         | 2005 |  23602.90 |
| Moroni      | Maurizio      | 2003 |  38524.29 |
| Moroni      | Maurizio      | 2004 |  51619.02 |
| Frick       | Michael       | 2003 |   5494.78 |
| Frick       | Michael       | 2004 |  22602.36 |
| Frick       | Michael       | 2004 |  44400.50 |
| Donnermeyer | Michael       | 2004 |  31310.09 |
| Barajas     | Miguel        | 2004 |  51152.86 |
| Barajas     | Miguel        | 2004 |   4424.40 |
| Holz        | Mihael        | 2004 |  47375.92 |
| Holz        | Mihael        | 2004 |  61402.00 |
| Gao         | Mike          | 2003 |  45480.79 |
| Graham      | Mike          | 2003 |   2880.00 |
| Graham      | Mike          | 2004 |  37281.36 |
| Graham      | Mike          | 2004 |  39440.59 |
| Graham      | Mike          | 2005 |  75020.13 |
| Kentary     | Mory          | 2004 |  15183.63 |
| Kentary     | Mory          | 2004 |  47177.59 |
| Ibsen       | Palle         | 2003 |  36164.46 |
| Ibsen       | Palle         | 2004 |  53745.34 |
| Accorti     | Paolo         | 2004 |  33924.24 |
| Accorti     | Paolo         | 2004 |  48298.99 |
| Cartrain    | Pascale       | 2003 |   1627.56 |
| Cartrain    | Pascale       | 2003 |   1128.20 |
| Cartrain    | Pascale       | 2004 |  12081.52 |
| Cartrain    | Pascale       | 2005 |  14379.90 |
| Henriot     | Paul          | 2003 |  13920.26 |
| Henriot     | Paul          | 2003 |  16700.47 |
| Henriot     | Paul          | 2005 |  49705.52 |
| Henriot     | Paul          | 2005 |  46656.94 |
| Ferguson    | Peter         | 2003 |  45864.03 |
| Ferguson    | Peter         | 2003 |   7565.08 |
| Ferguson    | Peter         | 2004 |  82261.22 |
| Ferguson    | Peter         | 2004 |  44894.74 |
| Koskitalo   | Pirkko        | 2003 |  32723.04 |
| Koskitalo   | Pirkko        | 2004 |  16212.59 |
| Koskitalo   | Pirkko        | 2005 |  46770.52 |
| Ashworth    | Rachel        | 2003 |  48425.69 |
| Ashworth    | Rachel        | 2004 |  52825.29 |
| Ashworth    | Rachel        | 2004 |  47159.11 |
| Keitel      | Roland        | 2003 |  10549.01 |
| Keitel      | Roland        | 2003 |  24101.81 |
| Mendel      | Roland        | 2003 |  27121.90 |
| Mendel      | Roland        | 2003 |  15130.97 |
| Keitel      | Roland        | 2004 |  33820.62 |
| Keitel      | Roland        | 2004 |   7466.32 |
| Mendel      | Roland        | 2005 |   8807.12 |
| Salazar     | Rosa          | 2003 |  25833.14 |
| Salazar     | Rosa          | 2004 |   5899.38 |
| Salazar     | Rosa          | 2004 |  45994.07 |
| McRoy       | Sarah         | 2004 |  35034.57 |
| McRoy       | Sarah         | 2004 |  31670.37 |
| Clenahan    | Sean          | 2003 |  35505.63 |
| Clenahan    | Sean          | 2004 |   9415.13 |
| Frick       | Steve         | 2003 |  36092.40 |
| Thompson    | Steve         | 2003 |   7678.25 |
| Frick       | Steve         | 2004 |  42339.76 |
| Thompson    | Steve         | 2004 |  36070.47 |
| Taylor      | Sue           | 2003 |  29997.09 |
| Frick       | Sue           | 2004 |  59551.38 |
| Taylor      | Sue           | 2004 |  12573.28 |
| Nelson      | Susan         | 2003 |  11044.30 |
| Nelson      | Susan         | 2003 | 111654.40 |
| Nelson      | Susan         | 2003 |  45084.38 |
| Nelson      | Susan         | 2004 |  85410.87 |
| Nelson      | Susan         | 2004 |  47142.70 |
| Nelson      | Susan         | 2004 |  55639.66 |
| Nelson      | Susan         | 2004 |  43369.30 |
| Nelson      | Susan         | 2005 | 101244.59 |
| Nelson      | Susan         | 2005 |  83598.04 |
| Smith       | Thomas        | 2003 |  22275.73 |
| Smith       | Thomas        | 2004 |   7310.42 |
| Snowden     | Tony          | 2003 |  32077.44 |
| Snowden     | Tony          | 2004 |  52166.00 |
| Snowden     | Tony          | 2005 |  30253.75 |
| Franco      | Valarie       | 2003 |  59265.14 |
| Thompson    | Valarie       | 2004 |  80375.24 |
| Franco      | Valarie       | 2004 |   6276.60 |
| Oeztan      | Veysel        | 2003 |  85024.46 |
| Oeztan      | Veysel        | 2004 |  12538.01 |
| Benitez     | Violeta       | 2003 |   9977.85 |
| Benitez     | Violeta       | 2004 |  48355.87 |
| Benitez     | Violeta       | 2005 |  30293.77 |
| MacKinlay   | Wales         | 2003 |  20220.04 |
| MacKinlay   | Wales         | 2004 |  36442.34 |
| Victorino   | Wendy         | 2004 |  38785.48 |
| Victorino   | Wendy         | 2004 |  44160.92 |
| Victorino   | Wendy         | 2004 |  22474.17 |
| Brown       | William       | 2004 |   7178.66 |
| Brown       | William       | 2004 |  31102.85 |
| Huang       | Wing          | 2003 |  41016.75 |
| Huang       | Wing          | 2003 |  52548.49 |
| Huang       | Wing          | 2005 |   8307.28 |
| Tamuri      | Yoshi         | 2003 |  36527.61 |
| Tamuri      | Yoshi         | 2004 |  33594.58 |
| Choi        | Yu            | 2004 |  27550.51 |
| Choi        | Yu            | 2004 |   1679.92 |
+-------------+---------------+------+-----------+
273 rows in set (0.00 sec)  */